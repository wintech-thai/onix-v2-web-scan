# Quick Start Guide - ONIX v2 Web Scan

**Version:** 2.0.0  
**Last Updated:** 2025-01-22  
**Status:** âœ… Ready for Development

---

## ğŸš€ Getting Started

### Prerequisites
- Node.js 22.x LTS
- npm, yarn, pnpm, or bun
- Git

### Installation

```bash
# 1. Navigate to the Next.js application
cd onix-v2-web-scan/nextjs

# 2. Install dependencies
npm install

# 3. Configure environment variables
cp .env.example .env.local
# Edit .env.local with your configuration

# 4. Start development server
npm run dev
```

**Server URL:** http://localhost:5001

---

## ğŸ“ Project Structure

```
onix-v2-web-scan/
â”œâ”€â”€ nextjs/                          # Next.js 15 Application
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ layout.tsx              # App metadata & global layout
â”‚   â”‚   â”œâ”€â”€ page.tsx                # Home page
â”‚   â”‚   â””â”€â”€ verify/
â”‚   â”‚       â””â”€â”€ page.tsx            # Verification page (Server Component)
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ HamburgerMenu.tsx       # Mobile menu (Client Component) â­ NEW
â”‚   â”‚   â””â”€â”€ themes/default/
â”‚   â”‚       â””â”€â”€ VerifyView.tsx      # Main verification UI (Client Component)
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ types.ts                # TypeScript interfaces
â”‚   â”‚   â”œâ”€â”€ translations.ts         # Thai/English translations
â”‚   â”‚   â”œâ”€â”€ encryption.ts           # AES decryption utilities
â”‚   â”‚   â””â”€â”€ redis.ts                # Redis client (optional)
â”‚   â”œâ”€â”€ public/                     # Static assets
â”‚   â”œâ”€â”€ middleware.ts               # Audit logging middleware
â”‚   â””â”€â”€ package.json                # Dependencies
â””â”€â”€ .github/
    â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md   # Complete implementation docs
    â”œâ”€â”€ BUG_FIX_USESTATE_ERROR.md  # Recent bug fix details â­ NEW
    â”œâ”€â”€ TESTING_CHECKLIST.md        # Testing guide â­ NEW
    â””â”€â”€ tasks/                      # Task tracking
```

---

## ğŸ”§ Recent Changes (2025-01-22)

### âœ… Bug Fix: useState Error
**Problem:** Application crashed with "useState only works in Client Components" error  
**Solution:** Extracted `HamburgerMenu` to separate client component file  
**Status:** Fixed and verified

**Files Changed:**
- âœ¨ Created: `nextjs/components/HamburgerMenu.tsx` (Client Component)
- ğŸ“ Updated: `nextjs/app/verify/page.tsx` (removed inline component)

**Details:** See `.github/BUG_FIX_USESTATE_ERROR.md`

---

## ğŸ¯ Key Features

### 1. Verification System
- QR code / URL-based product verification
- AES-256-CBC encryption decryption
- Status display: Success (green), Warning (orange), Error (red)
- Bilingual support: Thai (default) and English

### 2. UI Components
- âœ… No status badge (removed as requested)
- âœ… Registration button (conditional rendering based on status)
- âœ… Two modal flows:
  - Already-registered modal (shows email)
  - Registration form modal (email + OTP)
- âœ… Responsive hamburger menu for language selection
- âœ… Mobile-first design

### 3. Registration Logic (Status-Based)
| Status | Registration Button | Modal Flow |
|--------|-------------------|-----------|
| `SUCCESS` | âœ… Show | Already Registered |
| `CUSTOMER_NOT_ATTACH` | âœ… Show | Registration Form |
| `CUSTOMER_NOTFOUND` | âœ… Show | Registration Form |
| Others (VALID, ERROR, etc.) | âŒ Hide | N/A |

---

## ğŸŒ Testing URLs

### Test Page (Mock Data)
```
http://localhost:5001/test?scenario=valid&lang=en
http://localhost:5001/test?scenario=expired&lang=th
http://localhost:5001/test?scenario=error
```

### Verify Page (Real Data)
```
http://localhost:5001/verify?data=[encrypted-data]&theme=default&org=napbiotec&lang=en
```

**Available Scenarios:**
- `?scenario=valid` - Success state
- `?scenario=expired` - Warning state
- `?scenario=error` - Error state
- `?scenario=with-product` - With product images
- `?scenario=already-registered` - Already registered warning

**Language Options:**
- `?lang=th` - Thai (default)
- `?lang=en` - English

---

## ğŸ› ï¸ Development Commands

```bash
# Start development server (port 5001)
npm run dev

# Build for production
npm run build

# Start production server
npm run start

# Run linter
npm run lint

# Type checking
npm run type-check
```

---

## âš ï¸ Known Limitations

### 1. API Integration Pending
- **OTP Send Endpoint:** Not yet connected (placeholder in code)
- **Registration Endpoint:** Not yet connected (placeholder in code)
- **Location:** `nextjs/components/themes/default/VerifyView.tsx`
- **Search for:** `// TODO: Replace with actual API call`

### 2. UX Improvements Needed
- Replace `alert()` with toast notifications (e.g., react-hot-toast)
- Add inline validation messages for email and OTP
- Add resend OTP countdown timer
- Add loading spinners during API calls
- Add success flow to refresh verification after registration

### 3. Security Enhancements Needed
- Backend email validation
- OTP expiry/time limits
- Rate limiting for OTP requests
- Anti-abuse measures

---

## ğŸ“– Documentation

| Document | Purpose |
|----------|---------|
| `QUICK_START.md` | This file - Quick reference guide |
| `.github/IMPLEMENTATION_SUMMARY.md` | Detailed implementation overview |
| `.github/BUG_FIX_USESTATE_ERROR.md` | useState bug fix documentation |
| `.github/TESTING_CHECKLIST.md` | Complete testing checklist |
| `API_INTEGRATION_GUIDE.md` | API integration steps and examples |
| `README_UI_UPDATES.md` | UI changes documentation |

---

## ğŸ” Troubleshooting

### Issue: "useState only works in Client Components"
**Status:** âœ… FIXED (2025-01-22)  
**Solution:** HamburgerMenu extracted to separate client component  
**Details:** See `.github/BUG_FIX_USESTATE_ERROR.md`

### Issue: Port 5001 already in use
```bash
# Kill process on port 5001
lsof -ti:5001 | xargs kill -9

# Or use a different port
PORT=5002 npm run dev
```

### Issue: Module not found errors
```bash
# Clear Next.js cache and reinstall
rm -rf .next node_modules package-lock.json
npm install
npm run dev
```

### Issue: TypeScript errors
```bash
# Check for errors
npm run type-check

# Or check specific file
npx tsc --noEmit app/verify/page.tsx
```

---

## ğŸ§ª Testing

### Quick Test
```bash
# 1. Start server
npm run dev

# 2. Open browser
open http://localhost:5001/test?scenario=valid&lang=en

# 3. Verify:
# - Page loads without errors
# - Hamburger menu works
# - Language switching works
# - Registration button appears (for appropriate statuses)
```

### Complete Testing
Follow the checklist in `.github/TESTING_CHECKLIST.md`

---

## ğŸš¦ Next Steps

### Immediate (High Priority)
1. âœ… ~~Fix useState error~~ (COMPLETED)
2. ğŸ”„ Test application thoroughly (use TESTING_CHECKLIST.md)
3. ğŸ”„ Integrate API endpoints for OTP and registration
4. ğŸ”„ Replace alert() with toast notifications

### Short Term (Medium Priority)
1. Add email validation (frontend + backend)
2. Add OTP resend functionality with countdown
3. Add loading states and better error messages
4. Implement success flow after registration
5. Add unit tests for components

### Long Term (Low Priority)
1. Add analytics/telemetry
2. Add rate limiting
3. Add comprehensive error tracking
4. Performance optimization
5. Accessibility audit and improvements

---

## ğŸ‘¥ Getting Help

### Resources
- **Swagger API:** Check your API documentation for endpoint details
- **Next.js Docs:** https://nextjs.org/docs
- **React Docs:** https://react.dev
- **TypeScript Docs:** https://www.typescriptlang.org/docs

### Common Questions

**Q: How do I add a new language?**  
A: Update `nextjs/lib/translations.ts` and add new language key.

**Q: How do I change the port?**  
A: Update `PORT` in `.env.local` or use `PORT=XXXX npm run dev`

**Q: How do I add a new status type?**  
A: Update status logic in `VerifyView.tsx` and add translations.

**Q: Where are the API calls?**  
A: Currently placeholders in `VerifyView.tsx`. See `API_INTEGRATION_GUIDE.md` for integration steps.

---

## âœ… Current Status

- âœ… UI Implementation Complete
- âœ… Bug Fixes Applied
- âœ… TypeScript Compilation Clean
- âœ… Development Server Running
- âœ… Documentation Updated
- ğŸ”„ API Integration Pending
- ğŸ”„ Production Testing Pending

---

## ğŸ“ Notes

- **No unit tests yet** - Required before production deployment
- **API integration pending** - See API_INTEGRATION_GUIDE.md
- **Alert() used for errors** - Should replace with toast notifications
- **Basic validation only** - Backend validation required for security

---

**Last Verified:** 2025-01-22  
**Developer:** GitHub Copilot  
**Status:** Ready for Development & Testing